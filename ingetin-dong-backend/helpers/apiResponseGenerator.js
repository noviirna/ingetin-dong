const { log } = require("./logger");

module.exports = {
  /**
   * This method generate standard api response
   * @param {httpRequest} request ,  httpRequest object that is generated by each request from client
   * @param {httpResponse} response,  httpResponse object that is generated by each request from client
   * @param {Object} processedResponse, consist of {code: int of httpStatus code i.e. 200, status: String of httpStatus i.e. 'Created', message: String of message i.e. 'Success login', data: any }
   */
  generateSuccessResponse(request, response, processedResponse) {
    const { timestamp, traceId } = request;
    const { code, status, message, data } = processedResponse;
    var body = {
      timestamp,
      traceId,
      apiSuccessResponse: {
        timestamp: new Date().toISOString(),
        code,
        status,
        message,
        ...data
      }
    };
    log.info("Response:", body, traceId);
    response.status(code).json(body);
  },
  /**
   * This method generate standard api error response
   * @param {httpRequest} request ,  httpRequest object that is generated by each request from client
   * @param {httpResponse} response,  httpResponse object that is generated by each request from client
   * @param {Object} processedResponse, consist of {code: int of httpStatus code i.e. 200, status: String of httpStatus i.e. 'Created', message: String of message i.e. 'Success login', data: any }
   */
  generateErrorResponse(request, response, processedResponse) {
    const { timestamp, traceId } = request;
    const { code, status, message } = processedResponse;
    response.status(code).json({
      timestamp,
      traceId,
      apiErrorResponse: {
        timestamp: new Date().toISOString(),
        code,
        status,
        message
      }
    });
  }
};
